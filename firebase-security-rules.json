{
  "rules": {
    // Messages - anyone can read, but only authenticated users can write
    "messages": {
      ".read": true,
      ".write": "auth != null",
      "$messageId": {
        ".validate": "newData.hasChildren(['username', 'message', 'timestamp']) && newData.child('username').isString() && newData.child('message').isString()"
      }
    },

    // User data - users can only access their own data
    "users": {
      "$userId": {
        ".read": "$userId == auth.uid || root.child('admins').child(auth.uid).exists()",
        ".write": "$userId == auth.uid || root.child('admins').child(auth.uid).exists()",
        ".validate": "newData.hasChildren(['points']) && newData.child('points').isNumber()"
      }
    },

    // Accounts - only the user can access their own account
    "accounts": {
      "$username": {
        ".read": "auth != null && (auth.uid == $username || root.child('admins').child(auth.uid).exists())",
        ".write": "auth != null && (auth.uid == $username || root.child('admins').child(auth.uid).exists())"
      }
    },

    // Chat settings - only admins can modify
    "chatSettings": {
      ".read": true,
      ".write": "root.child('admins').child(auth.uid).exists()"
    },

    // Admins list - only existing admins can modify
    "admins": {
      ".read": "auth != null && root.child('admins').child(auth.uid).exists()",
      ".write": "auth != null && root.child('admins').child(auth.uid).exists()"
    },

    // Game results and system data - read-only for users, write for authenticated
    "gameResults": {
      ".read": true,
      ".write": "auth != null"
    },

    // Leaderboard data - read for all, write for authenticated
    "leaderboard": {
      ".read": true,
      ".write": "auth != null"
    },

    // Default deny everything else
    ".read": false,
    ".write": false
  }
}